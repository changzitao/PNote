## 旁路缓存模式
### 介绍
读取缓存，读取数据库，更新缓存都是在应用程序完成的，常用的策略。
### 执行流程
接收到请求，从缓存中读取数据，不存在则查询数据库，返回时存入缓存，返回响应。
可以使用饿汉模式/懒汉模式
### 数据一致性保障
- 更新数据库，更新缓存。ab双线程更新完数据库后，不保证更改缓存的顺序，可能有脏数据。
- 先删除缓存，再更新数据库。（更新缓存可能导致不一致）a删除缓存后，b线程查询数据库写入缓存，a更新数据库。造成了脏数据问题
- 更新数据库，再删缓存。a线程在更新数据库时，b线程读取缓存，a删除缓存。期间存在数据不一致问题。删除失败则会造成长时间不一致。
- 延迟双删。先删除缓存，更新数据库，再删除缓存。
- 
## 读写穿透
### 介绍
服务不直接与缓存数据库打交道，封装一层，通过cacheProvider执行旁路缓存。
与旁路缓存不同的一点是 写入缓存，而旁路则是删除缓存。
### 执行流程
接收到请求，从cacheprivoder获取数据，cacheprivoder从缓存获取（不存在则查询数据库并写入缓存），返回响应。
写入时同步写入缓存与数据库。
### 适用场景
写操作多，数据一致性要求高（性能差，更新数据更新缓存都需要同步，都要使用分布式锁）银行系统会使用。
## 异步写回模式
### 介绍
由cachePrivoder负责缓存和数据库读写。写入时，异步回血模式只更新缓存，不同步更新数据库，而异步批量的写入数据库，读写穿透则是同步更新缓存+数据库。
### 执行流程
接收到请求，从cacheprivoder获取数据，cacheprivoder从缓存获取（不存则查询数据库，写入缓存）返回响应。
写入时，写入缓存，当服务压力较小时，批量写入数据库。
### 适用场景
适合数据频繁变化，且对数据一致性要求不高的场景，如浏览量，点赞数。

## 三大模式比较
- 旁路缓存实现简单，但是需要维护2套数据存储。
- 读写穿透应用程序与cacheprivoder配合使用，简化了应用开发，但是cacheprivoder的实现比较复杂。
- 异步回写与读写穿透 区别是异步回写模式的数据持久化是异步的，而读写穿透的数据持久化是同步的。
- 异步回写模式优点速度快，直接操作缓存，多次更新数据合并后持久化到数据库，缺点数据可能丢失，例如系统断电。